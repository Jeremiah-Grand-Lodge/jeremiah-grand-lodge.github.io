<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Members Area – Jeremiah Grand Lodge, AF&AM</title>
<style>
body{font-family:Georgia,serif;background:#F7F6F2;padding:20px}
.hidden{display:none}
.post{background:#fff;border:1px solid #ddd;padding:12px;margin-bottom:10px}
</style>
</head>
<body>

<h2>Members Area – Jeremiah Grand Lodge, AF&AM</h2>

<div id="login">
<input id="email" placeholder="Email"><br>
<input id="password" type="password"><br>
<button id="loginBtn">Login</button>
</div>

<div id="content" class="hidden">
<button id="logoutBtn">Logout</button>
<h3>Member Messages</h3>
<div id="posts"></div>

<h4>New Message</h4>
<input id="title" placeholder="Title"><br>
<textarea id="body"></textarea><br>
<button id="postBtn">Post</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = const firebaseConfig = {
  apiKey: "XXXXX",
  authDomain: "XXXXX.firebaseapp.com",
  projectId: "XXXXX",
  storageBucket: "XXXXX.appspot.com",
  messagingSenderId: "XXXXX",
  appId: "XXXXX"
};
;

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

loginBtn.onclick = ()=>signInWithEmailAndPassword(auth,email.value,password.value);
logoutBtn.onclick = ()=>signOut(auth);

postBtn.onclick = async ()=>{
 await addDoc(collection(db,"posts"),{title:title.value,body:body.value,ts:Date.now()});
 title.value=''; body.value='';
};

onAuthStateChanged(auth,user=>{
 login.classList.toggle("hidden",!!user);
 content.classList.toggle("hidden",!user);
 if(user){
  const q=query(collection(db,"posts"),orderBy("ts","desc"));
  onSnapshot(q,s=>{
   posts.innerHTML='';
   s.forEach(d=>{
    const p=d.data();
    posts.innerHTML+=`<div class="post"><b>${p.title}</b><br>${p.body}</div>`;
   });
  });
 }
});
</script>

</body>
</html>
