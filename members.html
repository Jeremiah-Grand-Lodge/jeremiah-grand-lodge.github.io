<!DOCTYPE html>
<html>
<head>
<title>Members Area – Jeremiah Grand Lodge, AF&AM</title>
<meta charset="UTF-8">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<style>
body{font-family:Georgia,serif;background:#F7F6F2;padding:20px}
.hidden{display:none}
.post{background:#fff;padding:12px;border:1px solid #ddd;margin-bottom:10px}
</style>
</head>
<body>

<h2>Members Area – Jeremiah Grand Lodge, AF&AM</h2>

<div id="login">
<input id="email" placeholder="Email"><br>
<input id="password" type="password" placeholder="Password"><br>
<button onclick="login()">Login</button>
</div>

<div id="content" class="hidden">
<button onclick="logout()">Logout</button>
<h3>Member Messages</h3>
<div id="posts"></div>

<h4>New Message</h4>
<input id="title" placeholder="Title"><br>
<textarea id="body"></textarea><br>
<button onclick="post()">Post</button>
</div>

<script>
const firebaseConfig = const firebaseConfig = {
  apiKey: "XXXXX",
  authDomain: "XXXXX.firebaseapp.com",
  projectId: "XXXXX",
  storageBucket: "XXXXX.appspot.com",
  messagingSenderId: "XXXXX",
  appId: "XXXXX"
};
;

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(user=>{
 document.getElementById('login').classList.toggle('hidden',!!user);
 document.getElementById('content').classList.toggle('hidden',!user);
 load();
});

function login(){
 auth.signInWithEmailAndPassword(email.value,password.value);
}

function logout(){ auth.signOut(); }

function post(){
 db.collection("posts").add({title:title.value,body:body.value,ts:Date.now()});
}

function load(){
 db.collection("posts").orderBy("ts","desc").onSnapshot(s=>{
  posts.innerHTML='';
  s.forEach(d=>{
   let p=d.data();
   posts.innerHTML+=`<div class="post"><b>${p.title}</b><br>${p.body}</div>`;
  });
 });
}
</script>

</body>
</html>
